"use strict";(self.webpackChunkmintlayer_docs=self.webpackChunkmintlayer_docs||[]).push([[182],{6619:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"whitepaper/decentralized-finance-defi","title":"4. Decentralized Finance (DeFi)","description":"4.1. Script-based smart contracts and Turing incompleteness","source":"@site/docs/whitepaper/4-decentralized-finance-defi.md","sourceDirName":"whitepaper","slug":"/whitepaper/decentralized-finance-defi","permalink":"/mintlayer-docs/docs/whitepaper/decentralized-finance-defi","draft":false,"unlisted":false,"editUrl":"https://github.com/mintlayer/mintlayer-docs/tree/main/docs/whitepaper/4-decentralized-finance-defi.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"3. Tokenization standard","permalink":"/mintlayer-docs/docs/whitepaper/tokenization-standard"},"next":{"title":"5. Decentralized Exchange (DEX)","permalink":"/mintlayer-docs/docs/whitepaper/decentralized-exchange-dex"}}');var s=i(4848),a=i(8453);const r={},o="4. Decentralized Finance (DeFi)",c={},l=[{value:"4.1. Script-based smart contracts and Turing incompleteness",id:"41-script-based-smart-contracts-and-turing-incompleteness",level:2},{value:"4.2. Security tokens and stablecoins",id:"42-security-tokens-and-stablecoins",level:2},{value:"4.3. ACL rules for securities",id:"43-acl-rules-for-securities",level:2},{value:"4.4. Decentralized Identity (DID) and Oracles",id:"44-decentralized-identity-did-and-oracles",level:2},{value:"4.5. Programmable Pools (dividends, taxation)",id:"45-programmable-pools-dividends-taxation",level:2}];function d(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"4-decentralized-finance-defi",children:"4. Decentralized Finance (DeFi)"})}),"\n",(0,s.jsx)(t.h2,{id:"41-script-based-smart-contracts-and-turing-incompleteness",children:"4.1. Script-based smart contracts and Turing incompleteness"}),"\n",(0,s.jsx)(t.p,{children:"Smart contracts on a blockchain mostly consist of particular conditions for locking and unlocking funds. There are three common approaches to smart contracts in the crypto ecosystem: the script-based primarily used in Bitcoin, the Solidity contract used in the Ethereum Virtual Machine (EVM), and, more recently, the Web Assembly Virtual Machine (WASM), seen in projects like EOS or Polkadot."}),"\n",(0,s.jsx)(t.p,{children:"Both EVM and WASM are Turing-complete, which means that the system can process whatever rule-set of data manipulation, opening up virtually infinite possibilities for developers to create smart contracts. Instead, Mintlayer uses the Bitcoin-like script-based approach: it is non-Turing complete and therefore limited by a determined set of rules that must be followed. This approach sacrifices some versatility in exchange for higher safety, sustainability, and speed of validation."}),"\n",(0,s.jsx)(t.p,{children:"Generally, script-based smart contracts tend to produce less network pollution and execute faster than Turing-complete contracts, thus ensuring a more manageable environment for developers. On the contrary, complicated architectures on blockchains end up causing more issues than benefits: having endless possibilities might end up clogging servers, while at its core, a Turing-complete system is not even required by most blockchain applications."}),"\n",(0,s.jsxs)(t.p,{children:["The Ethereum whitepaper ",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-finance-defi#footnotes",children:" ($$^1\u200e^0$$)"})," states that \u201cTuring-incompleteness is not even that big of a limitation\u201d. Out of all the contract examples that the Ethereum team had conceived when writing a whitepaper, only one required a loop, and even that loop could be removed by making 26 repetitions of a one-line piece of code. A more recent study",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-finance-defi#footnotes",children:" ($$^1\u200e^1$$)"})," says that only 6,9% of smart contracts built on the Ethereum Virtual Machine truly require Turing-complete language functions. It also notes that the vast majority of Ethereum\u2019s smart contracts can be coded to function the same way on a Turing-incomplete machine."]}),"\n",(0,s.jsx)(t.p,{children:"To prevent potentially infinite loops in an EVM environment, which requires excessive resources, the contract execution is limited by the gas (ETH). The problem is, when a smart contract runs out of gas, the transaction is nullified (the fee in ETH gas is paid to the miner in any case). Therefore, it is necessary to provide enough gas in advance to cover the worst-case scenario, which is very difficult to foresee."}),"\n",(0,s.jsx)(t.p,{children:"It is one of the main reasons why Solidity smart contracts have shown a higher probability of breaking over time: among the historical failures, more notable ones are the DAO hack and Parity's multiple signature validation program. On the other hand, the possibilities provided by a script-based system are sufficient and proportionate to the purpose of Mintlayer\u2019s DeFi and DEX functionalities, without incurring the risks of Turing completeness. By combining several simple scripts, it is possible to produce highly advanced contracts."}),"\n",(0,s.jsxs)(t.p,{children:["Two very primitive script-based smart contracts are the ",(0,s.jsx)(t.strong,{children:"multi-signature account"})," and the ",(0,s.jsx)(t.strong,{children:"time lock"}),". ",(0,s.jsx)(t.strong,{children:"Multi-signature"})," requires a number n of signatures over m to unlock a specific unspent output, whereas ",(0,s.jsx)(t.strong,{children:"time lock"})," requires that the output is spent only after block x, or only n blocks after the event x occurred (event x might also be a particular transaction or block). Combining these two simple scripts together makes it possible to create sophisticated contracts while keeping the high reliability, efficiency, and predictability of their basic components."]}),"\n",(0,s.jsx)(t.p,{children:"The potentiality and versatility of a script-based approach are well expressed in the development of a very particular smart contract, which has been the major focus of the entire Bitcoin developers\u2019 community in the last years: Lightning Network. It allows locking funds in a bilateral channel between two nodes (A and B), while particular unlocking requirements let the nodes update the balance of bitcoins held by each one."}),"\n",(0,s.jsx)(t.p,{children:"The revolutionary innovation is the possibility to combine more of these bilateral channels to create a payment route across the network. If a third node C is connected to B through a second channel, the bitcoins can flow between all the nodes A, B, and C just by updating the balances of two channels. Extending this mechanism to a vast network of channels can effectively create an off-chain peer-to-peer layer on top of Bitcoin, allowing to send and receive bitcoin without using transactions written on the blockchain."}),"\n",(0,s.jsxs)(t.p,{children:["Mintlayer supports Lightning Network for all MLS-01 tokens and other HTLC script-based contracts used explicitly for the DEX, like atomic swap (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-exchange-dex#5-2-the-atomic-swap-dex",children:"\xa75.2."}),") or lightning swaps (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-exchange-dex#5-7-lightning-network-dex",children:"\xa75.7."}),"), which are also interoperable with the Bitcoin blockchain."]}),"\n",(0,s.jsx)(t.h2,{id:"42-security-tokens-and-stablecoins",children:"4.2. Security tokens and stablecoins"}),"\n",(0,s.jsx)(t.p,{children:"On Mintlayer, MLS-01 tokens represent the most versatile tokenization technology to digitize securities. Tokenizing security means representing an ownership right (such as shares in a company) or a credit in a token. This right is usually guaranteed by the token issuer, who is contractually bound to recognize the token as a bearer security."}),"\n",(0,s.jsx)(t.p,{children:"The token can also represent an asset in the issuer's custody: an example is stablecoin Tether, which has the dollar as its underlying asset, held by Tether Inc. On a theoretical level, stablecoins can be included within the broader definition of security tokens, although in some jurisdictions, the classification may be different for legal reasons."}),"\n",(0,s.jsx)(t.p,{children:"While cryptocurrencies like Bitcoin are issued in a decentralized way, the issuance of security is always centralized, meaning the issuing entity is also prosecutable by the authorities or central entities. Despite this, the advantage of a blockchain for security is palpable: the blockchain is the first technology capable of transferring bearer securities in digital form without relying on a centralized system."}),"\n",(0,s.jsx)(t.p,{children:"In the case of security tokens, the topic revolves around the transfer, not the issuance. However, it still makes the difference as the security can be sold directly by the company without intermediaries or even traded on a DEX for other cryptocurrencies (i.e., Bitcoin). The token may also grant administrative rights concerning company shares, where the token buyer exercises his rights cryptographically and anonymously by demonstrating ownership of the security using his private key."}),"\n",(0,s.jsx)(t.p,{children:"Mintlayer\u2019s architecture offers various tools for developing decentralized finance with particular regard for securities: Access-Control-List with verification through a decentralized identity, programmable pools to pay dividends, and tax transactions."}),"\n",(0,s.jsx)(t.p,{children:"It is possible to picture a future in which companies or self-employed people freely issue shares or bonds on a blockchain and then transfer them without any friction. Private arbitrators elected by the parties handle fraud cases of the token issuer. Examples of fraud cases might be:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The business profits are not redistributed as scheduled based on the distribution of the assigned tokens;"}),"\n",(0,s.jsx)(t.li,{children:"The administrative rights associated with the token are denied;"}),"\n",(0,s.jsx)(t.li,{children:"The token inflation does not meet the expected schedule, or tokens are burned/locked by the issuer against the terms of the public offering."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Some of these frauds might be prevented if the MLS-01 token representing the security is issued without the possibility for the token issuer to intervene in these factors, such as the generation of new tokens (inflation control). However, in most cases, such rigidity might not be well-suited for securities. Therefore, when serious disputes arise, the token\u2019s digital nature and the total absence of frictions in the exchanges would immediately lead to a fall in its value, undermining the issuer\u2019s credibility. This incentive mechanism provides a market equilibrium in the use of these instruments."}),"\n",(0,s.jsx)(t.h2,{id:"43-acl-rules-for-securities",children:"4.3. ACL rules for securities"}),"\n",(0,s.jsx)(t.p,{children:"Access-Control-List (ACL) acts as a filter dedicated to limit the transferability property of a token. By default, any address can transfer and use the token without any limitations unless the token creator defined some ACL upon its launch. Among the rules defined, there is also the possibility (or impossibility) to change those rules in the future once the token is live on the mainnet."}),"\n",(0,s.jsx)(t.p,{children:"One purpose that can be identified for ACL is to allow trading and transfer of security tokens that need to comply with particular company policies or legislation. Some limits can be enforced on the input or the output of a transaction."}),"\n",(0,s.jsx)(t.p,{children:"On the input side:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"It is possible to enforce an upper or lower bound on the amount transferred;"}),"\n",(0,s.jsx)(t.li,{children:"Time locks can be enforced (i.e., the UTXO cannot be spent until block x);"}),"\n",(0,s.jsx)(t.li,{children:"A particular address can be blocked so that all UTXO from that address are frozen and cannot be transferred."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"On the output side:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Only specific addresses can receive a transaction: in this case, the standard policy is to deny the transaction unless the requirement is met (the output address is whitelisted);"}),"\n",(0,s.jsx)(t.li,{children:"A certain address cannot receive a transaction: in this case, the standard policy is to allow any transaction unless the restriction is met (the output address is blacklisted);"}),"\n",(0,s.jsx)(t.li,{children:"Conditional whitelisting/blacklisting: a particular address can or cannot receive the transaction depending on the amount transferred (upper or lower bounds) or the lock time;"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["From a technical point of view, the rules are enforced through one or a series of filters and an action: ",(0,s.jsx)(t.em,{children:"allow, deny, or check:"})]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If the action is deny, and at least one of the filters is met, then the transaction cannot be validated;"}),"\n",(0,s.jsx)(t.li,{children:"In case of allow action, the transaction can be validated only if all the filters are met;"}),"\n",(0,s.jsx)(t.li,{children:"In case of check action, the transaction is validated only if it passes another set of rules used for another token. The check action can be used in case of multiple tokens issued with the same policy conditions or if more tokens share a common set of rules (recalled with check) on top of which other rules are specifically enforced for each different token. For example, the token issuer can specify or inherit the ACL that is already defined by a trusted third party in charge of the AML/KYC procedures."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["An additional ",(0,s.jsx)(t.em,{children:"control"})," parameter can be configured when there is a need for a particular entity to approve each transaction of the token. The entity is defined as \u201ccontroller\u201d and shall \u201ccountersign\u201d the transaction for its validation. The difference from a simple 2/2 multi-signature is that this ACL control rule requiring the controller's signature can be combined with other ACL rules or any other desired multi-signature scheme for the UTXO. For example, the users might use a \u2157 multi-sig account to hold the tokens, which can only be transferred by providing at least 3 signatures together with the controller\u2019s signature (so that it effectively becomes a 4/6 scheme) and whatever other ACL rules that are configured for that token."]}),"\n",(0,s.jsxs)(t.p,{children:["The controller can be the token issuer, a service, an identity provider, or more generically, an oracle. The standard identification procedure required to ask the controller for the countersignature can be performed using the DID (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-finance-defi#4-4-decentralized-identity-did-and-oracles",children:"\xa74.4."}),")."]}),"\n",(0,s.jsx)(t.h2,{id:"44-decentralized-identity-did-and-oracles",children:"4.4. Decentralized Identity (DID) and Oracles"}),"\n",(0,s.jsx)(t.p,{children:"The Mintlayer full node and light node provide a tool for creating a digital identity represented by a pair of keys: public and private. These keys can be used to encrypt/decrypt or sign/verify messages and verify the \u201cdecentralized identity\u201d."}),"\n",(0,s.jsxs)(t.p,{children:["The DID can be used to \u201csign-up\u201d or \u201clogin\u201d to services of an oracle or directly as data is processed by the oracles to identify a particular user for generating statistics or ranking (i.e., for the DEX transactions). In general, oracles empower the blockchain\u2019s inner mechanisms with data unavailable inside the blockchain. AML/KYC oracles may certify the DID countersigning their transactions to meet ACL rules. In contrast, other oracles might help the wallets perform specific tasks, such as provide better reliability of the atomic swap allowed by the watchtowers (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/tokenization-standard#3-2-4-atomic-swap",children:"\xa73.2.4."}),"). Observers (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-exchange-dex#5-4-observer-of-multiparty-swaps",children:"\xa75.4."}),") and book aggregators (",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-exchange-dex#5-5-book-aggregators-for-multiparty-swaps",children:"\xa75.5."}),") in DEX help synchronize the DHT and create storage for a proper order book."]}),"\n",(0,s.jsxs)(t.p,{children:["Technically, the DID is a master public key (also known as Account Extended Public Key",(0,s.jsx)(t.a,{href:"/mintlayer-docs/docs/whitepaper/decentralized-finance-defi#footnotes",children:" $$^1\u200e^2$$"}),") produced by a wallet\u2019s built-in tool. It is possible to use DID as one of the keys derived from that master key. The master private key or the derived private keys are used to sign the message, proving the user\u2019s identity."]}),"\n",(0,s.jsx)(t.p,{children:"Services may rely on a trusted third party that acts as a personal identity verifier (i.e., a KYC provider) so that the user does not need to submit the KYC procedures for all the registration processes with every service. Instead, users execute the KYC with a single identity provider and then verify themselves with all the services by signing a message with their DID."}),"\n",(0,s.jsx)(t.p,{children:"The user may also publicly sign up for different services with different public keys, all derived by the same master public key used for the registration to the KYC provider so that the signup is not publicly attributable to the user\u2019s physical identity. In this case, since the user privately provided the derivation path to the service he is using, only the service (and not even the KYC provider) can trace the DID back to the master public key. The service asks the KYC provider for personal information only if it is necessary for compliance reasons."}),"\n",(0,s.jsx)(t.h2,{id:"45-programmable-pools-dividends-taxation",children:"4.5. Programmable Pools (dividends, taxation)"}),"\n",(0,s.jsx)(t.p,{children:"There are occasions when using script-based transactions can cause more network pollution, for example, when moving small amounts that are not consolidated in a single account, as it happens on account-based systems (i.e., Ethereum). For this reason, Mintlayer allows users to switch from UTXO to an account base with programmable pools."}),"\n",(0,s.jsx)(t.p,{children:"A programmable pool can be used to pay out dividends or collect \u201ctax\u201d on each transaction of a specific token. Some tokens can be created with ACL rules, requiring that each transaction passes through the programmable pool. In that case, the transaction will necessarily execute the programmable pool\u2019s rule set to be validated, which may enforce sending a fee to a specific address (taxation) or all the addresses holding a certain amount of tokens (dividends)."}),"\n",(0,s.jsx)(t.p,{children:"The amounts paid for taxes and dividends increase the balance of an account-based recipient, not a UTXO. The accounts can be cleared with a transaction by creating a new UTXO of the same amount of money in the account-based balance (minus the fee paid to the blockmaker for that transaction)."}),"\n",(0,s.jsx)(t.p,{children:"The rule set of a programmable pool can be configured by its creator, indicating the address or addresses entitled to collect the taxes/dividends or the rule by which those addresses are selected:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Dividends"}),": an address can receive a share of the funds held in an indicated reserve, depending on how many tokens it stores (which might be security tokens representing quotas of the shareholders). The programmable pool creator defines:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Specific address(es) entitled to receive the funds, proportionally distributed to a set of UTXO;"}),"\n",(0,s.jsx)(t.li,{children:"A defined share of funds the beneficiary needs to hold, which is required to be eligible as a beneficiary of the dividends;"}),"\n",(0,s.jsx)(t.li,{children:"The reserve address(es) from where dividends are paid;"}),"\n",(0,s.jsx)(t.li,{children:"The combination with any ACL filter."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Taxation"}),": an indicated address can receive taxes for each transaction made with a specific token. The programmable pool\u2019s creator defines:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The address that collects the taxes;"}),"\n",(0,s.jsx)(t.li,{children:"A fixed quantity of token to be paid as tax for each transaction;"}),"\n",(0,s.jsx)(t.li,{children:"In other cases, a specific percentage of the amount transferred to be used as a tax."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"To create a pool and execute the pool\u2019s functionalities, it is necessary to broadcast a transaction with a specific OP_CODE. The pool rule set can be configured to determine a pool owner who has the ability to update or destroy the pool."}),"\n",(0,s.jsx)(t.p,{children:"The smart contracts within a programmable pool might have Turing complete functionalities, in this case the advantages of a Turing incomplete system are not applicable."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>o});var n=i(6540);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);